# ğŸŒ ì›¹ ê²€ìƒ‰ ë³´ì™„ ê¸°ëŠ¥ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ê²€ìƒ‰ ê²°ê³¼ê°€ 3ê°œ ë¯¸ë§Œì¼ ë•Œ ìë™ìœ¼ë¡œ ì›¹ ê²€ìƒ‰ì„ í†µí•´ ê²°ê³¼ë¥¼ ë³´ì™„í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

### 1. ìë™ ì›¹ ê²€ìƒ‰ ë³´ì™„

- **ì¡°ê±´**: ë‚´ë¶€ ë°ì´í„°ë² ì´ìŠ¤ ê²€ìƒ‰ ê²°ê³¼ê°€ 3ê°œ ë¯¸ë§Œ
- **ë™ì‘**: ìë™ìœ¼ë¡œ ì›¹ ê²€ìƒ‰ì„ ì‹¤í–‰í•˜ì—¬ ë¶€ì¡±í•œ ê²°ê³¼ ë³´ì™„
- **ëª©í‘œ**: ìµœì†Œ 3-5ê°œì˜ ê²€ìƒ‰ ê²°ê³¼ ì œê³µ

### 2. ìŠ¤ë§ˆíŠ¸ í‚¤ì›Œë“œ ìƒì„±

```
ì‚¬ìš©ì ì¿¼ë¦¬: "ìŠ¤íƒ€ë²…ìŠ¤ í˜œíƒ"
ìƒì„± í‚¤ì›Œë“œ:
- "ìŠ¤íƒ€ë²…ìŠ¤ í˜œíƒ"
- "ì¹´í˜ í• ì¸ í˜œíƒ"
- "ì¹´í˜ ì¿ í°"
- "ìŠ¤íƒ€ë²…ìŠ¤ í• ì¸"
```

### 3. ë‹¤ë‹¨ê³„ ê²€ìƒ‰ ì „ëµ

1. **1ì°¨**: ë„¤ì´ë²„ ê²€ìƒ‰ API (API í‚¤ ì„¤ì • ì‹œ)
2. **2ì°¨**: ì¼ë°˜ ì›¹ ê²€ìƒ‰ (API ì‹¤íŒ¨ ì‹œ ëŒ€ì•ˆ)
3. **ê²°ê³¼**: RAG í˜•ì‹ìœ¼ë¡œ í†µí•© ì œê³µ

## ğŸ”§ ì„¤ì • ë°©ë²•

### 1. ë„¤ì´ë²„ API í‚¤ ì„¤ì • (ê¶Œì¥)

```bash
# .env íŒŒì¼ì— ì¶”ê°€
NAVER_CLIENT_ID=your_naver_client_id
NAVER_CLIENT_SECRET=your_naver_client_secret
```

### 2. API í‚¤ ë°œê¸‰ ë°©ë²•

1. [ë„¤ì´ë²„ ê°œë°œìì„¼í„°](https://developers.naver.com/) ì ‘ì†
2. ë¡œê·¸ì¸ í›„ "ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡" í´ë¦­
3. ê²€ìƒ‰ API ì„ íƒ
4. Client IDì™€ Client Secret ë°œê¸‰

### 3. ì„¤ì • í™•ì¸

```bash
# í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
cd ec2/
python test_web_search.py
```

## ğŸ“Š ê¸°ëŠ¥ ë™ì‘ ê³¼ì •

### ì¼ë°˜ ê²€ìƒ‰ í”„ë¡œì„¸ìŠ¤

```mermaid
graph TD
    A[ì‚¬ìš©ì ì¿¼ë¦¬] --> B[ì¹´í…Œê³ ë¦¬/ë¸Œëœë“œ ì¶”ì¶œ]
    B --> C[ë‚´ë¶€ DB ê²€ìƒ‰]
    C --> D{ê²°ê³¼ 3ê°œ ì´ìƒ?}
    D -->|ì˜ˆ| E[ê²°ê³¼ ë°˜í™˜]
    D -->|ì•„ë‹ˆì˜¤| F[ì›¹ ê²€ìƒ‰ ë³´ì™„]
    F --> G[ê²°ê³¼ í†µí•©]
    G --> E
```

### ì›¹ ê²€ìƒ‰ ë³´ì™„ í”„ë¡œì„¸ìŠ¤

```mermaid
graph TD
    A[ì›¹ ê²€ìƒ‰ ì‹œì‘] --> B[í‚¤ì›Œë“œ ìƒì„±]
    B --> C{ë„¤ì´ë²„ API í‚¤ ìˆìŒ?}
    C -->|ì˜ˆ| D[ë„¤ì´ë²„ ê²€ìƒ‰ API]
    C -->|ì•„ë‹ˆì˜¤| E[ì¼ë°˜ ê²€ìƒ‰]
    D --> F{ê²°ê³¼ ì¶©ë¶„?}
    E --> F
    F -->|ì•„ë‹ˆì˜¤| G[ì¶”ê°€ ê²€ìƒ‰]
    F -->|ì˜ˆ| H[RAG í˜•ì‹ ë³€í™˜]
    G --> H
    H --> I[ê²°ê³¼ ë°˜í™˜]
```

## ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ

### ì˜ˆì‹œ 1: ë°ì´í„°ë² ì´ìŠ¤ ê²°ê³¼ ë¶€ì¡±

```json
{
  "query": "ì•„ë§ˆì¡´ í”„ë¼ì„ í˜œíƒ",
  "results": [
    {
      "search_type": "web_search",
      "metadata": {
        "title": "ì•„ë§ˆì¡´ í”„ë¼ì„ ë©¤ë²„ì‹­ í˜œíƒ ì´ì •ë¦¬",
        "source": "ì›¹ê²€ìƒ‰",
        "url": "https://example.com/amazon-prime"
      }
    }
  ],
  "web_search_used": true
}
```

### ì˜ˆì‹œ 2: ì¶©ë¶„í•œ ë‚´ë¶€ ë°ì´í„°

```json
{
  "query": "ìŠ¤íƒ€ë²…ìŠ¤ í˜œíƒ",
  "results": [
    {
      "search_type": "vector",
      "metadata": {
        "title": "ìŠ¤íƒ€ë²…ìŠ¤ ì‚¬ì´ë Œì˜¤ë” ì ë¦½",
        "source": "ë‚´ë¶€ë°ì´í„°"
      }
    }
  ],
  "web_search_used": false
}
```

## ğŸ” ê²€ìƒ‰ ê²°ê³¼ êµ¬ì¡°

### ì›¹ ê²€ìƒ‰ ê²°ê³¼ í˜•ì‹

```json
{
  "id": "web_ìŠ¤íƒ€ë²…ìŠ¤í˜œíƒ_0",
  "metadata": {
    "title": "ìŠ¤íƒ€ë²…ìŠ¤ í• ì¸ í˜œíƒ ì•ˆë‚´",
    "brand": "ìŠ¤íƒ€ë²…ìŠ¤",
    "category": "ì¹´í˜",
    "benefit_type": "ì›¹ê²€ìƒ‰",
    "discount_rate": "ìƒì„¸ì •ë³´ í™•ì¸ í•„ìš”",
    "conditions": "ì›¹ì‚¬ì´íŠ¸ í™•ì¸ í•„ìš”",
    "source": "ì›¹ê²€ìƒ‰",
    "url": "https://example.com/starbucks",
    "search_keyword": "ìŠ¤íƒ€ë²…ìŠ¤ í˜œíƒ"
  },
  "document": "ìŠ¤íƒ€ë²…ìŠ¤ í• ì¸ í˜œíƒ ì•ˆë‚´. ë©¤ë²„ì‹­ ê°€ì… ì‹œ ë‹¤ì–‘í•œ í˜œíƒ ì œê³µ",
  "similarity_score": 0.7,
  "search_type": "web_search"
}
```

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### ë¡œê·¸ ë©”ì‹œì§€ ì˜ˆì‹œ

```
ğŸŒ ê²€ìƒ‰ ê²°ê³¼ ë¶€ì¡± (1ê°œ) - ì›¹ ê²€ìƒ‰ìœ¼ë¡œ ë³´ì™„
ğŸ” ì›¹ ê²€ìƒ‰ í‚¤ì›Œë“œ: ['ìŠ¤íƒ€ë²…ìŠ¤ í˜œíƒ', 'ì¹´í˜ í• ì¸ í˜œíƒ']
ğŸŒ ì›¹ ê²€ìƒ‰ ì™„ë£Œ: 2ê°œ ê²°ê³¼ íšë“
ğŸ”„ ì›¹ ê²€ìƒ‰ ë³´ì™„ í›„: 3ê°œ ê²°ê³¼
```

### API ì‘ë‹µì—ì„œ í™•ì¸

```json
{
  "web_search_used": true,
  "search_strategy": {
    "categories_found": ["ì¹´í˜"],
    "brands_found": ["ìŠ¤íƒ€ë²…ìŠ¤"],
    "vector_search_used": true,
    "web_search_triggered": true
  }
}
```

## ğŸ› ï¸ ê³ ê¸‰ ì„¤ì •

### 1. ê²€ìƒ‰ ì„ê³„ê°’ ë³€ê²½

```python
# rag_system.pyì—ì„œ ìˆ˜ì •
if len(final_results) < 3:  # 3ì—ì„œ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë³€ê²½
```

### 2. ì›¹ ê²€ìƒ‰ í‚¤ì›Œë“œ ìˆ˜ ì¡°ì •

```python
# ìµœëŒ€ í‚¤ì›Œë“œ ìˆ˜ ë³€ê²½
for keyword in search_keywords[:2]:  # 2ì—ì„œ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë³€ê²½
```

### 3. ì›¹ ê²€ìƒ‰ ê²°ê³¼ ìˆ˜ ì¡°ì •

```python
# ì›¹ ê²€ìƒ‰ì—ì„œ ê°€ì ¸ì˜¬ ê²°ê³¼ ìˆ˜
naver_results = self._search_naver_api(keyword, min(needed, 3))  # 3 ë³€ê²½
```

## ğŸš¨ ë¬¸ì œ í•´ê²°

### 1. ì›¹ ê²€ìƒ‰ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ” ê²½ìš°

```bash
# API í‚¤ í™•ì¸
echo $NAVER_CLIENT_ID
echo $NAVER_CLIENT_SECRET

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python test_web_search.py
```

### 2. ê²€ìƒ‰ ê²°ê³¼ê°€ ë¶€ì •í™•í•œ ê²½ìš°

- í‚¤ì›Œë“œ ìƒì„± ë¡œì§ í™•ì¸
- ì¹´í…Œê³ ë¦¬/ë¸Œëœë“œ ì¶”ì¶œ ì •í™•ë„ ì ê²€
- ê²€ìƒ‰ API ì‘ë‹µ ìƒíƒœ í™•ì¸

### 3. ì„±ëŠ¥ ì´ìŠˆ

- ì›¹ ê²€ìƒ‰ íƒ€ì„ì•„ì›ƒ ì¡°ì • (í˜„ì¬ 10ì´ˆ)
- ë™ì‹œ ê²€ìƒ‰ í‚¤ì›Œë“œ ìˆ˜ ì œí•œ
- ìºì‹± ê¸°ëŠ¥ ì¶”ê°€ ê³ ë ¤

## ğŸ“Š í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ìë™ í…ŒìŠ¤íŠ¸

```bash
cd ec2/
python test_web_search.py
```

### 2. ìˆ˜ë™ API í…ŒìŠ¤íŠ¸

```bash
curl -X POST http://localhost/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "ì•„ë§ˆì¡´ í”„ë¼ì„ í˜œíƒ", "user_id": "test"}'
```

### 3. ì›¹ ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸

- `http://localhost/`ì—ì„œ íŠ¹ìˆ˜í•œ ê²€ìƒ‰ì–´ ì…ë ¥
- ì‘ë‹µì—ì„œ `web_search_used: true` í™•ì¸

## ğŸ‰ ê¸°ëŒ€ íš¨ê³¼

1. **ê²€ìƒ‰ ê²°ê³¼ ë³´ì¥**: í•­ìƒ 3ê°œ ì´ìƒì˜ ê²€ìƒ‰ ê²°ê³¼ ì œê³µ
2. **ìµœì‹  ì •ë³´**: ì›¹ì—ì„œ ì‹¤ì‹œê°„ ì •ë³´ ìˆ˜ì§‘
3. **ì‚¬ìš©ì ë§Œì¡±ë„**: ë¹ˆ ê²°ê³¼ ëŒ€ì‹  ìœ ìš©í•œ ì •ë³´ ì œê³µ
4. **ì‹œìŠ¤í…œ ì‹ ë¢°ë„**: ë°ì´í„°ë² ì´ìŠ¤ ë¶€ì¡± ìƒí™© ìë™ í•´ê²°

## ğŸ“ ê°œë°œ ë…¸íŠ¸

- ì›¹ ê²€ìƒ‰ ê²°ê³¼ëŠ” similarity_score 0.5-0.7 ë²”ìœ„ë¡œ ì„¤ì •
- ë„¤ì´ë²„ API ì‹¤íŒ¨ ì‹œ ì¼ë°˜ ê²€ìƒ‰ìœ¼ë¡œ ìë™ ëŒ€ì²´
- HTML íƒœê·¸ ìë™ ì œê±° ë° í…ìŠ¤íŠ¸ ì •ë¦¬
- ë¸Œëœë“œ/ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜ ë° íƒœê¹…
